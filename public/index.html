<!DOCTYPE html>
<html>
<head>
    <title>Smog</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.12.0/moment.min.js"></script>
    <script src="script/Chart.js-2.0.0-beta/Chart.js"></script>
    <script src="http://code.highcharts.com/highcharts.js"></script>
    <script src="http://code.highcharts.com/modules/heatmap.js"></script>
    <script src="http://code.highcharts.com/modules/exporting.js"></script>
    <script src="script/wnumb-1.0.2/wNumb.js"></script>
    <script src="script/noUiSlider/nouislider.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.5/css/materialize.min.css">
    <link rel="stylesheet" href="script/noUiSlider/nouislider.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.5/js/materialize.min.js"></script>
    <link rel="stylesheet" type="text/css" href="smog_switches.css">
    <style>
        .switch label input[type=checkbox]#checkTemperature:checked + .lever {
            background-color: rgba(230, 81, 0, 0.5);
        }
        .switch label input[type=checkbox]#checkTemperature:checked + .lever:after {
            background-color: rgba(230, 81, 0, 1);
        }

        .switch label input[type=checkbox]#checkWind:checked + .lever {
            background-color: rgba(66, 66, 66, 0.5);
        }
        .switch label input[type=checkbox]#checkWind:checked + .lever:after {
            background-color: rgba(66, 66, 66, 1);
        }

        .switch label input[type=checkbox]#checkPressure:checked + .lever {
            background-color: rgba(156, 39, 176, 0.5);
        }
        .switch label input[type=checkbox]#checkPressure:checked + .lever:after {
            background-color: rgba(156, 39, 176, 1);
        }

        .switch label input[type=checkbox]#checkRain:checked + .lever {
            background-color: rgba(1, 87, 155, 0.5);
        }
        .switch label input[type=checkbox]#checkRain:checked + .lever:after {
            background-color: rgba(1, 87, 155, 1);
        }

        .switch label input[type=checkbox]#checkHumidity:checked + .lever {
            background-color: rgba(100, 181, 246, 0.5);
        }
        .switch label input[type=checkbox]#checkHumidity:checked + .lever:after {
            background-color: rgba(100, 181, 246, 1);
        }

        /*#date .connect {*/
            /*position: absolute;*/
            /*top: 0;*/
            /*bottom: 0;*/
            /*background: #80C9F5;*/
            /*box-shadow: inset 0 0 3px rgba(51,51,51,0.45);*/
        /*}*/
        .tabs {
        @include flexbox();
            height: 38px;
        }
        .tabs .tab a {
            font-size: 12px;
        }
        .tabs .tab {
            height: 38px;
        }
        .container .section {
            padding-bottom: 0px;
        }

        #heatmap {
            width: 1000px;
            height: 600px;
            margin: 5em auto;
        }
    </style>

</head>

    <body>
        <div class="container">
            <div class="section" style="margin-bottom: 0px">
                <div class="row">
                    <div class="col s10">
                        <label for="date">Data:</label>
                        <!--<input id="date" type="date" class="datepicker" placeholder="02-03-2014" onchange="updateWeatherData(); updateSmogData();">-->
                        <!--<input id="date" type="date" class="datepicker" placeholder="2015-01-01" onchange="updateSmogData(); updateWeatherData();">-->
                        <div id="date" class="noUi-target noUi-ltr noUi-horizontal noUi-background">
                            <!--<div class="noUi-base">-->
                                <!--<div class="noUi-origin" style="left: 10.8626%;">-->
                                    <!--<div class="noUi-handle noUi-handle-lower">-->
                                    <!--</div>-->
                                <!--</div>-->
                                <!--<div class="noUi-origin" style="left: 83.3866%;">-->
                                    <!--<div class="noUi-handle noUi-handle-upper">-->
                                    <!--</div>-->
                                <!--</div>-->
                            <!--</div>-->
                        </div>
                        <span>Od</span>
                        <span id="from-date"></span>
                        <span>do</span>
                        <span id="to-date"></span>
                    </div>

                    <div class="input-field col s2">
                        <select id="station" onchange="updateSmogData()">
                            <option value="" disabled>Wybierz stację</option>
                            <option selected value="6">Stacja 6</option>
                            <option value="7">Stacja 7</option>
                            <option value="16">Stacja 16</option>
                            <option value="149">Stacja 149</option>
                            <option value="152">Stacja 152</option>
                            <option value="153">Stacja 153</option>
                        </select>
                        <label for="station">Stacja:</label>
                    </div>
                </div>
            </div>
            <!--<ul class="tabs">-->
                <!--<li class="tab col s2"><a href="#weather" style="color: #00c853 ">Pogoda</a></li>-->
                <!--<li class="tab col s2"><a class="active" href="#smog" style="color: #00c853 ">Smog</a></li>-->
                <!--<div class="indicator green accent-4" style="z-index:1"></div>-->
            <!--</ul>-->
            <ul class="tabs">
            <li class="tab col s2"><a class="active" href="#weather_smog" style="color: #00c853 ">Pogoda i smog</a></li>
            <li class="tab col s2"><a href="#heatmap" style="color: #00c853 ">Heatmap</a></li>
            <div class="indicator green accent-4" style="z-index:1"></div>
            </ul>
            <div id="heatmap">

            </div>
            <div id="weather_smog">
                <div class="section">
                    <div id="weather" class="row">
                        <div class="col s9">
                            <h5>Pogoda</h5>
                            <canvas id="weatherChart" width="950%" height="400"></canvas>
                        </div>
                        <!-- Switch -->
                        <div class="col s3">
                            <div class="row">
                                <div class="switch">
                                    <label>
                                        Temperatura
                                        <br>
                                        <input type="checkbox"  id="checkTemperature" onchange="updateTemperatureChart()">
                                        <span class="lever"></span>
                                    </label>
                                    <br>
                                    <label>
                                        Wiatr
                                        <br>
                                        <input checked="checked" type="checkbox" id="checkWind" onchange="updateWindSpeedChart()">
                                        <span class="lever"></span>
                                    </label>
                                    <br>
                                    <label>
                                        Ciśnienie
                                        <br>
                                        <input checked="checked" type="checkbox" id="checkPressure" onchange="updatePerssureChart()">
                                        <span class="lever"></span>
                                    </label>
                                    <br>
                                    <label>
                                        Opady
                                        <br>
                                        <input checked="checked" type="checkbox" id="checkRain" onchange="updateRainChart()">
                                        <span class="lever"></span>
                                    </label>
                                    <br>
                                    <label>
                                        Wilgotność
                                        <br>
                                        <input checked="checked" type="checkbox" id="checkHumidity" onchange="updateHumidityChart()">
                                        <span class="lever"></span>
                                    </label>
                                </div>
                            </div>
                        </div>
                        <!--<h5>Zachmurzenie</h5>-->
                        <!--<canvas id="cloudyChart" width="1000" height="200"></canvas>-->
                        <!--<h5>Wilgotność</h5>-->
                        <!--<canvas id="humidityChart" width="1000" height="200"></canvas>-->
                        <!--<h5>Prędkość wiatru</h5>-->
                        <!--<canvas id="windSpeedChart" width="1000" height="200"></canvas>-->
                    </div>
                </div>

                <div class="section">
                    <div id="smog" class="row">
                        <div class="col s9">
                            <h5>Smog</h5>
                            <canvas id="smogChart" width="950%" height="400"></canvas>
                        </div>
                        <!-- Switches -->
                        <div class="col s3">
                            <div class="row">
                                <div class="col s6">
                                    <div class="switch">
                                        <label>
                                            Dwutlenek Azotu
                                            <input checked type="checkbox" id="dwutlenekAzotuSwitch">
                                            <span class="lever"></span>
                                        </label>
                                        <br>
                                        <label>
                                            Tlenek Azotu
                                            <input type="checkbox" id="tlenekAzotuSwitch">
                                            <span class="lever"></span>
                                        </label>
                                        <br>
                                        <label>
                                            Tlenki Azotu
                                            <input type="checkbox" id="tlenkiAzotuSwitch">
                                            <span class="lever"></span>
                                        </label>
                                        <br>
                                        <label>
                                            Pyl Zawieszony Pm 10
                                            <input type="checkbox" id="pylZawieszonyPm10Switch">
                                            <span class="lever"></span>
                                        </label>
                                        <br>
                                        <label>
                                            Pyl Zawieszony Pm 2,5
                                            <input type="checkbox" id="pylZawieszonyPm25Switch">
                                            <span class="lever"></span>
                                        </label>
                                    </div>
                                </div>
                                <div class="col s6">
                                    <div class="switch">
                                        <label>
                                            Tlenek Wegla
                                            <input type="checkbox" id="tlenekWeglaSwitch">
                                            <span class="lever"></span>
                                        </label>
                                        <br>
                                        <label>
                                            Tlenek Wegla 8H
                                            <input type="checkbox" id="tlenekWegla8HSwitch">
                                            <span class="lever"></span>
                                        </label>
                                        <br>
                                        <label>
                                            Ozon<br>
                                            <input type="checkbox" id="ozonSwitch">
                                            <span class="lever"></span>
                                            <br>
                                        </label>
                                        <label>
                                            Ozon 8H<br>
                                            <input type="checkbox" id="ozon8HSwitch">
                                            <span class="lever"></span>
                                            <br>
                                        </label>
                                        <label>
                                            Benzen<br>
                                            <input type="checkbox" id="benzenSwitch">
                                            <span class="lever"></span>
                                        </label>
                                        <br>
                                        <label>
                                            Dwutlenek Siarki
                                            <input type="checkbox" id="dwutlenekSiarkiSwitch">
                                            <span class="lever"></span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <footer class="blue-grey lighten-1">
            <div class="container">
                <div class="row">
                    <div class="col s12">
                        <h5 class="white-text">Informacje</h5>
                        <p class="grey-text text-lighten-4">Prezentowana informacja jest w trakcie wdrażania i nie posiada jeszcze pełnej bazy wyników pomiarów.
                        <br>Serwis wykorzystuje dane zebrane od dnia 01.01.2014r.
                        <br>Dane dotyczące zanieczyszczeń zostały pobrane z serwisu: <a href="http://monitoring.krakow.pios.gov.pl/" style="color: #37474f;">http://monitoring.krakow.pios.gov.pl/</a>
                        <br>Dane dotyczące pogody uzyskaliśmy dzięki: <a href="http://meteo.ftj.agh.edu.pl/meteo/" style="color: #37474f;">http://meteo.ftj.agh.edu.pl/meteo/</a></p>
                    </div>
                    <!--<div class="col l4 offset-l2 s12">-->
                        <!--<h5 class="white-text">Links</h5>-->
                        <!--<ul>-->
                            <!--<li><a class="grey-text text-lighten-3" href="#!">Link 1</a></li>-->
                            <!--<li><a class="grey-text text-lighten-3" href="#!">Link 2</a></li>-->
                            <!--<li><a class="grey-text text-lighten-3" href="#!">Link 3</a></li>-->
                            <!--<li><a class="grey-text text-lighten-3" href="#!">Link 4</a></li>-->
                        <!--</ul>-->
                    <!--</div>-->
                </div>
            </div>
            <div class="footer-copyright">
                <div class="container">
                    <br>
                </div>
            </div>
        </footer>

        <!--<script src="weahterScripts.js"></script>-->
        <script src="smogScripts.js"></script>
        <script src="weahterScripts.js"></script>
        <script src="heatmapScripts.js"></script>
        <!--<script src="smogScripts.js"></script>-->

        <script>
            function timestamp(str) {
                return new Date(str).getTime();
            }

            function zfill(str, len) {
                return new Array(len - str.length + 1).join('0') + str;
            }

            function formatDate(time) {
                var date = new Date(time * 1);
                return (date.getYear() + 1900) + "-" + zfill((date.getMonth() + 1).toString(), 2) + "-" + zfill((date.getDate() + 1).toString(), 2);
            }

//            $('.datepicker').pickadate({
//                selectMonths: true, // Creates a dropdown to control month
//                selectYears: 15, // Creates a dropdown of 15 years to control year
//                format: 'yyyy-mm-dd'
//            });
            $(document).ready(function() {
                $('select').material_select();

                var dateSlider = document.getElementById("date");
                noUiSlider.create(dateSlider, {
                    range: {
                        min: timestamp('2014-01-01'),
                        max: timestamp('2016-04-06')
                    },

                    steps: 1000 * 60 * 60, // hours

                    connect: true,

                    start: [ timestamp(new Date().toString()), timestamp(new Date().toString()) ],

                    behaviour: 'tap-drag',

                    format: wNumb({
                        decimals: 0
                    })
                });

                var dateValues = [
                    document.getElementById('from-date'),
                    document.getElementById('to-date')
                ];

                dateSlider.noUiSlider.on('update', function( values, handle ) {
                    dateValues[handle].innerHTML = formatDate(values[handle]);
                });

                dateSlider.noUiSlider.on('change', function() {
                    updateWeatherData();
                    updateSmogData();
                    updateHeatMap();
                });

//                var connectBar = document.createElement('div'),
//                    connectBase = dateSlider.querySelector('.noUi-base');
//
//                // Give the bar a class for styling and add it to the slider.
//                connectBar.className += 'connect';
//                connectBase.appendChild(connectBar);
//
//                dateSlider.noUiSlider.on('update', function( values, handle, a, b, handlePositions ) {
//
//                    var offset = handlePositions[handle];
//
//                    // Right offset is 100% - left offset
//                    if ( handle === 1 ) {
//                        offset = 100 - offset;
//                    }
//
//                    // Pick left for the first handle, right for the second.
//                    connectBar.style[handle ? 'right' : 'left'] = offset + '%';
//                });
            });
        </script>
    </body>
</html>